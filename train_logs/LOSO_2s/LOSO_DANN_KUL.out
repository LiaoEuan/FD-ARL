========================================================
作业启动 (Job Start)
作业名 (Job Name): LOSO_DANN_AAD
作业ID (Job ID): 3615
运行节点 (Node List): gpu01
起始时间 (Start Time): Sun Sep 14 09:38:16 CST 2025
--------------------------------------------------------
当前工作目录 (Working Directory): /share/home/yuan/DTU_KUL_LOSO_2s
--------------------------------------------------------
正在加载环境模块 (cuda, anaconda3)...
正在激活 Conda 环境: ly_torch...
Conda 环境激活成功。当前Python路径: /share/home/yuan/.conda/envs/ly_torch/bin/python
--------------------------------------------------------
开始执行Python LOSO脚本 (testdann_keep1.py)...
这将会是一个漫长的过程，请耐心等待。
--------------------------------------------------------
Error importing huggingface_hub.hf_api: No module named 'filelock'
================================================================================
任务: LOSO-CV - Disentangled DANN-DBformer on KUL (2s-window)
主结果路径: ./LOSO_Disentangled_DANN_DBformer_RESULTS_KUL_2s_2025-09-14_09-38-21
================================================================================

============================== FOLD 1/16 (Test Subject: S1) ==============================
正在创建DataLoaders...
数据集加载完成，处理被试: ['2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16'], 总样本数: 43080
数据集加载完成，处理被试: ['1'], 总样本数: 2872
训练集: 43080 样本, 测试集: 2872 样本
--- 开始特征解耦领域对抗训练 (15 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 60.69%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 61.70%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 67.03%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 67.31%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 65.88%
本折训练完成！最佳测试准确率: 0.6793


============================== FOLD 2/16 (Test Subject: S2) ==============================
正在创建DataLoaders...
数据集加载完成，处理被试: ['1', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16'], 总样本数: 43080
数据集加载完成，处理被试: ['2'], 总样本数: 2872
训练集: 43080 样本, 测试集: 2872 样本
--- 开始特征解耦领域对抗训练 (15 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 82.63%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 80.85%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 86.46%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 88.75%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 85.76%
本折训练完成！最佳测试准确率: 0.8875


============================== FOLD 3/16 (Test Subject: S3) ==============================
正在创建DataLoaders...
数据集加载完成，处理被试: ['1', '2', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16'], 总样本数: 43080
数据集加载完成，处理被试: ['3'], 总样本数: 2872
训练集: 43080 样本, 测试集: 2872 样本
--- 开始特征解耦领域对抗训练 (15 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 58.11%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 53.20%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 54.32%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 54.87%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 53.20%
本折训练完成！最佳测试准确率: 0.6654


============================== FOLD 4/16 (Test Subject: S4) ==============================
正在创建DataLoaders...
数据集加载完成，处理被试: ['1', '2', '3', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16'], 总样本数: 43080
数据集加载完成，处理被试: ['4'], 总样本数: 2872
训练集: 43080 样本, 测试集: 2872 样本
--- 开始特征解耦领域对抗训练 (15 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 64.87%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 61.25%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 59.44%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 60.38%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 59.96%
本折训练完成！最佳测试准确率: 0.6563


============================== FOLD 5/16 (Test Subject: S5) ==============================
正在创建DataLoaders...
数据集加载完成，处理被试: ['1', '2', '3', '4', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16'], 总样本数: 43080
数据集加载完成，处理被试: ['5'], 总样本数: 2872
训练集: 43080 样本, 测试集: 2872 样本
--- 开始特征解耦领域对抗训练 (15 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 77.19%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 85.34%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 87.81%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 85.03%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 85.45%
本折训练完成！最佳测试准确率: 0.8861


============================== FOLD 6/16 (Test Subject: S6) ==============================
正在创建DataLoaders...
数据集加载完成，处理被试: ['1', '2', '3', '4', '5', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16'], 总样本数: 43080
数据集加载完成，处理被试: ['6'], 总样本数: 2872
训练集: 43080 样本, 测试集: 2872 样本
--- 开始特征解耦领域对抗训练 (15 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 47.70%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 46.94%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 47.84%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 47.67%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 47.67%
本折训练完成！最佳测试准确率: 0.5000


============================== FOLD 7/16 (Test Subject: S7) ==============================
正在创建DataLoaders...
数据集加载完成，处理被试: ['1', '2', '3', '4', '5', '6', '8', '9', '10', '11', '12', '13', '14', '15', '16'], 总样本数: 43080
数据集加载完成，处理被试: ['7'], 总样本数: 2872
训练集: 43080 样本, 测试集: 2872 样本
--- 开始特征解耦领域对抗训练 (15 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 61.73%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 61.80%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 64.45%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 64.73%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 65.67%
本折训练完成！最佳测试准确率: 0.6581


============================== FOLD 8/16 (Test Subject: S8) ==============================
正在创建DataLoaders...
数据集加载完成，处理被试: ['1', '2', '3', '4', '5', '6', '7', '9', '10', '11', '12', '13', '14', '15', '16'], 总样本数: 43080
数据集加载完成，处理被试: ['8'], 总样本数: 2872
训练集: 43080 样本, 测试集: 2872 样本
--- 开始特征解耦领域对抗训练 (15 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 76.04%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 77.23%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 77.65%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 79.87%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 77.86%
本折训练完成！最佳测试准确率: 0.7987


============================== FOLD 9/16 (Test Subject: S9) ==============================
正在创建DataLoaders...
数据集加载完成，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '10', '11', '12', '13', '14', '15', '16'], 总样本数: 43080
数据集加载完成，处理被试: ['9'], 总样本数: 2872
训练集: 43080 样本, 测试集: 2872 样本
--- 开始特征解耦领域对抗训练 (15 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 54.60%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 63.16%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 65.11%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 67.76%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 68.94%
本折训练完成！最佳测试准确率: 0.7201


============================== FOLD 10/16 (Test Subject: S10) ==============================
正在创建DataLoaders...
数据集加载完成，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '11', '12', '13', '14', '15', '16'], 总样本数: 43080
数据集加载完成，处理被试: ['10'], 总样本数: 2872
训练集: 43080 样本, 测试集: 2872 样本
--- 开始特征解耦领域对抗训练 (15 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 69.25%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 75.10%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 77.12%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 78.52%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 79.25%
本折训练完成！最佳测试准确率: 0.7932


============================== FOLD 11/16 (Test Subject: S11) ==============================
正在创建DataLoaders...
数据集加载完成，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '12', '13', '14', '15', '16'], 总样本数: 43080
数据集加载完成，处理被试: ['11'], 总样本数: 2872
训练集: 43080 样本, 测试集: 2872 样本
--- 开始特征解耦领域对抗训练 (15 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 51.22%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 50.42%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 51.01%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 52.09%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 51.81%
本折训练完成！最佳测试准确率: 0.5958


============================== FOLD 12/16 (Test Subject: S12) ==============================
正在创建DataLoaders...
数据集加载完成，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '13', '14', '15', '16'], 总样本数: 43080
数据集加载完成，处理被试: ['12'], 总样本数: 2872
训练集: 43080 样本, 测试集: 2872 样本
--- 开始特征解耦领域对抗训练 (15 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 52.37%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 51.29%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 52.26%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 53.83%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 54.07%
本折训练完成！最佳测试准确率: 0.5550


============================== FOLD 13/16 (Test Subject: S13) ==============================
正在创建DataLoaders...
数据集加载完成，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '14', '15', '16'], 总样本数: 43080
数据集加载完成，处理被试: ['13'], 总样本数: 2872
训练集: 43080 样本, 测试集: 2872 样本
--- 开始特征解耦领域对抗训练 (15 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 63.68%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 78.45%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 77.54%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 80.15%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 79.74%
本折训练完成！最佳测试准确率: 0.8357


============================== FOLD 14/16 (Test Subject: S14) ==============================
正在创建DataLoaders...
数据集加载完成，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '15', '16'], 总样本数: 43080
数据集加载完成，处理被试: ['14'], 总样本数: 2872
训练集: 43080 样本, 测试集: 2872 样本
--- 开始特征解耦领域对抗训练 (15 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 85.72%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 90.01%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 89.94%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 88.65%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 89.94%
本折训练完成！最佳测试准确率: 0.9077


============================== FOLD 15/16 (Test Subject: S15) ==============================
正在创建DataLoaders...
数据集加载完成，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '16'], 总样本数: 43080
数据集加载完成，处理被试: ['15'], 总样本数: 2872
训练集: 43080 样本, 测试集: 2872 样本
--- 开始特征解耦领域对抗训练 (15 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 65.98%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 67.24%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 65.60%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 65.42%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 66.43%
本折训练完成！最佳测试准确率: 0.6724


============================== FOLD 16/16 (Test Subject: S16) ==============================
正在创建DataLoaders...
数据集加载完成，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15'], 总样本数: 43080
数据集加载完成，处理被试: ['16'], 总样本数: 2872
训练集: 43080 样本, 测试集: 2872 样本
--- 开始特征解耦领域对抗训练 (15 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 92.10%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 93.87%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 94.53%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 94.43%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 96.20%
本折训练完成！最佳测试准确率: 0.9708


================================================================================
所有交叉验证折已完成！正在生成最终总结...
 fold test_subject  best_accuracy
    1           S1       0.679318
    2           S2       0.887535
    3           S3       0.665390
    4           S4       0.656337
    5           S5       0.886142
    6           S6       0.500000
    7           S7       0.658078
    8           S8       0.798747
    9           S9       0.720056
   10          S10       0.793175
   11          S11       0.595752
   12          S12       0.555014
   13          S13       0.835655
   14          S14       0.907730
   15          S15       0.672354
   16          S16       0.970752

平均准确率: 0.7464 ± 0.1367

❌ 脚本执行过程中发生错误: Object of type device is not JSON serializable
--------------------------------------------------------
Python脚本执行完毕，退出码 (Exit Code): 0
结束时间 (End Time): Sun Sep 14 11:12:01 CST 2025
作业结束 (Job End)
========================================================
