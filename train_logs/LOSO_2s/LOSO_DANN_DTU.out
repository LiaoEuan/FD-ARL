========================================================
作业启动 (Job Start)
作业名 (Job Name): LOSO_DANN_DTU
作业ID (Job ID): 3513
运行节点 (Node List): gpu01
起始时间 (Start Time): Sat Sep 13 11:23:14 CST 2025
--------------------------------------------------------
当前工作目录 (Working Directory): /share/home/yuan/DTU_KUL_LOSO_2s
--------------------------------------------------------
正在加载环境模块 (cuda, anaconda3)...
正在激活 Conda 环境: ly_torch...
Conda 环境激活成功。当前Python路径: /share/home/yuan/.conda/envs/ly_torch/bin/python
--------------------------------------------------------
开始执行Python LOSO脚本 (testdann_keep1.py)...
这将会是一个漫长的过程，请耐心等待。
--------------------------------------------------------
Error importing huggingface_hub.hf_api: No module named 'filelock'
================================================================================
任务: LOSO-CV - Disentangled DANN-DBformer on DTU (2s-window)
主结果路径: ./LOSO_Disentangled_DANN_DBformer_RESULTS_DTU_2s_2025-09-13_11-23-18
================================================================================

============================== FOLD 1/18 (Test Subject: S1) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['1']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 64.86%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 63.61%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 62.55%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 63.30%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 60.51%
本折训练完成！最佳测试准确率: 0.6544


============================== FOLD 2/18 (Test Subject: S2) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['1', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['2']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 56.12%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 54.66%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 52.69%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 52.24%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 51.50%
本折训练完成！最佳测试准确率: 0.5813


============================== FOLD 3/18 (Test Subject: S3) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['1', '2', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['3']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 53.10%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 53.06%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 50.17%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 51.36%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 50.54%
本折训练完成！最佳测试准确率: 0.5374


============================== FOLD 4/18 (Test Subject: S4) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['1', '2', '3', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['4']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 44.25%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 37.69%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 39.01%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 39.25%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 39.22%
本折训练完成！最佳测试准确率: 0.5830


============================== FOLD 5/18 (Test Subject: S5) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['1', '2', '3', '4', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['5']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 42.59%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 54.29%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 55.20%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 55.27%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 55.14%
本折训练完成！最佳测试准确率: 0.5667


============================== FOLD 6/18 (Test Subject: S6) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['1', '2', '3', '4', '5', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['6']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 50.34%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 47.11%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 47.89%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 48.33%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 48.03%
本折训练完成！最佳测试准确率: 0.5374


============================== FOLD 7/18 (Test Subject: S7) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['1', '2', '3', '4', '5', '6', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['7']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 60.10%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 63.20%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 64.12%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 61.63%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 63.67%
本折训练完成！最佳测试准确率: 0.6541


============================== FOLD 8/18 (Test Subject: S8) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['1', '2', '3', '4', '5', '6', '7', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['8']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 46.94%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 51.09%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 47.48%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 49.76%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 52.41%
本折训练完成！最佳测试准确率: 0.5793


============================== FOLD 9/18 (Test Subject: S9) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '10', '11', '12', '13', '14', '15', '16', '17', '18']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['9']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 50.41%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 48.44%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 48.57%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 48.44%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 50.71%
本折训练完成！最佳测试准确率: 0.6000


============================== FOLD 10/18 (Test Subject: S10) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '11', '12', '13', '14', '15', '16', '17', '18']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['10']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 53.84%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 56.56%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 56.43%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 55.92%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 54.49%
本折训练完成！最佳测试准确率: 0.5697


============================== FOLD 11/18 (Test Subject: S11) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '12', '13', '14', '15', '16', '17', '18']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['11']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 53.33%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 52.79%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 53.30%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 53.37%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 53.27%
本折训练完成！最佳测试准确率: 0.5340


============================== FOLD 12/18 (Test Subject: S12) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '13', '14', '15', '16', '17', '18']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['12']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 50.20%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 50.14%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 50.00%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 49.86%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 49.90%
本折训练完成！最佳测试准确率: 0.5037


============================== FOLD 13/18 (Test Subject: S13) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '14', '15', '16', '17', '18']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['13']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 56.94%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 49.49%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 48.78%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 47.55%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 47.52%
本折训练完成！最佳测试准确率: 0.6000


============================== FOLD 14/18 (Test Subject: S14) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '15', '16', '17', '18']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['14']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 48.95%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 49.39%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 48.47%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 48.78%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 48.44%
本折训练完成！最佳测试准确率: 0.5133


============================== FOLD 15/18 (Test Subject: S15) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '16', '17', '18']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['15']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 50.75%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 53.20%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 52.99%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 54.01%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 53.37%
本折训练完成！最佳测试准确率: 0.5796


============================== FOLD 16/18 (Test Subject: S16) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '17', '18']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['16']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 47.93%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 48.57%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 49.05%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 48.81%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 48.88%
本折训练完成！最佳测试准确率: 0.5136


============================== FOLD 17/18 (Test Subject: S17) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '18']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['17']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 52.04%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 52.65%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 51.53%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 52.86%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 54.39%
本折训练完成！最佳测试准确率: 0.5748


============================== FOLD 18/18 (Test Subject: S18) ==============================
正在创建DataLoaders...
开始构建2秒数据集，处理被试: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17']...
2秒数据集构建完成，总样本数: 49980
开始构建2秒数据集，处理被试: ['18']...
2秒数据集构建完成，总样本数: 2940
训练集: 49980 样本, 测试集: 2940 样本
--- 开始特征解耦领域对抗训练 (17 个训练领域) ---
Epoch 010/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 36.67%
Epoch 020/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 54.97%
Epoch 030/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 60.75%
Epoch 040/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 47.79%
Epoch 050/50 | Train L_Acc: 0.00%, D_Acc: 0.00% | Test Acc: 48.64%
本折训练完成！最佳测试准确率: 0.6333


================================================================================
所有交叉验证折已完成！正在生成最终总结...
 fold test_subject  best_accuracy
    1           S1       0.654422
    2           S2       0.581293
    3           S3       0.537415
    4           S4       0.582993
    5           S5       0.566667
    6           S6       0.537415
    7           S7       0.654082
    8           S8       0.579252
    9           S9       0.600000
   10          S10       0.569728
   11          S11       0.534014
   12          S12       0.503741
   13          S13       0.600000
   14          S14       0.513265
   15          S15       0.579592
   16          S16       0.513605
   17          S17       0.574830
   18          S18       0.633333

平均准确率: 0.5731 ± 0.0451

❌ 脚本执行过程中发生错误: Object of type device is not JSON serializable
--------------------------------------------------------
Python脚本执行完毕，退出码 (Exit Code): 0
结束时间 (End Time): Sat Sep 13 13:12:23 CST 2025
作业结束 (Job End)
========================================================
